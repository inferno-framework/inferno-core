<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Inferno::DSL::Assertions
  
    &mdash; Documentation by YARD 0.9.37
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Inferno::DSL::Assertions";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (A)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Inferno.html" title="Inferno (module)">Inferno</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../DSL.html" title="Inferno::DSL (module)">DSL</a></span></span>
     &raquo; 
    <span class="title">Assertions</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: Inferno::DSL::Assertions
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  
  <dl>
    <dt>Included in:</dt>
    <dd><span class='object_link'><a href="../Entities/TestGroup.html" title="Inferno::Entities::TestGroup (class)">Entities::TestGroup</a></span>, <span class='object_link'><a href="../Entities/TestSuite.html" title="Inferno::Entities::TestSuite (class)">Entities::TestSuite</a></span></dd>
  </dl>
  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/inferno/dsl/assertions.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>This module contains the assertions used within tests to verify the
behavior of the systems under test. Failing an assertion causes a test to
immediately stop execution and receive a <code>fail</code> result. Additional
assertions added to this module will be available in all tests.</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#assert-instance_method" title="#assert (instance method)">#<strong>assert</strong>(test, message = &#39;&#39;)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Make an assertion.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#assert_must_support_elements_present-instance_method" title="#assert_must_support_elements_present (instance method)">#<strong>assert_must_support_elements_present</strong>(resources, profile_url, validator_name: :default, metadata: nil, requirement_extension: nil) {|Metadata| ... } &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Check that all Must Support elements defined on the given profile are present in the given resources.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#assert_resource_type-instance_method" title="#assert_resource_type (instance method)">#<strong>assert_resource_type</strong>(resource_type, resource: self.resource)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Check a FHIR resource’s type.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#assert_response_content_type-instance_method" title="#assert_response_content_type (instance method)">#<strong>assert_response_content_type</strong>(type, request: self.request)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Check the Content-Type header of a response.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#assert_response_status-instance_method" title="#assert_response_status (instance method)">#<strong>assert_response_status</strong>(status, request: self.request, response: nil)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Check a response’s status.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#assert_valid_bundle_entries-instance_method" title="#assert_valid_bundle_entries (instance method)">#<strong>assert_valid_bundle_entries</strong>(bundle: resource, resource_types: {})  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Validate each entry of a Bundle.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#assert_valid_http_uri-instance_method" title="#assert_valid_http_uri (instance method)">#<strong>assert_valid_http_uri</strong>(uri, message = &#39;&#39;)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Check for a valid http/https uri.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#assert_valid_json-instance_method" title="#assert_valid_json (instance method)">#<strong>assert_valid_json</strong>(maybe_json_string, message = &#39;&#39;)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Check for valid JSON.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#assert_valid_resource-instance_method" title="#assert_valid_resource (instance method)">#<strong>assert_valid_resource</strong>(resource: self.resource, profile_url: nil, validator: :default)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Validate a FHIR resource.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="assert-instance_method">
  
    #<strong>assert</strong>(test, message = &#39;&#39;)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Make an assertion</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>test</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'><p>a value whose truthiness will determine whether the
assertion passes or fails</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>message</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>failure message</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Exceptions/AssertionException.html" title="Inferno::Exceptions::AssertionException (class)">Exceptions::AssertionException</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/inferno/dsl/assertions.rb', line 16</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assert'>assert</span><span class='lparen'>(</span><span class='id identifier rubyid_test'>test</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="../Exceptions.html" title="Inferno::Exceptions (module)">Exceptions</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Exceptions/AssertionException.html" title="Inferno::Exceptions::AssertionException (class)">AssertionException</a></span></span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span> <span class='kw'>unless</span> <span class='id identifier rubyid_test'>test</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="assert_must_support_elements_present-instance_method">
  
    #<strong>assert_must_support_elements_present</strong>(resources, profile_url, validator_name: :default, metadata: nil, requirement_extension: nil) {|Metadata| ... } &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Check that all Must Support elements defined on the given profile are present in the given resources.
Must Support elements are identified on the profile StructureDefinition and pre-parsed into metadata,
which may be customized prior to the check by passing a block. Alternate metadata may be provided directly.
Set test suite config flag debug_must_support_metadata: true to log the metadata to a file for debugging.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>resources</span>
      
      
        <span class='type'>(<tt>Array&lt;FHIR::Resource&gt;</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>profile_url</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>validator_name</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>:default</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Name of the FHIR Validator that references the IG the profile is in</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>metadata</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>MustSupport Metadata (optional),
if provided the check will use this instead of re-generating metadata from the profile</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>requirement_extension</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Extension URL that implies “required” as an alternative to the MS flag</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>Metadata</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Customize the metadata before running the test</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


215
216
217
218
219
220</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/inferno/dsl/assertions.rb', line 215</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_must_support_elements_present'>assert_must_support_elements_present</span><span class='lparen'>(</span><span class='id identifier rubyid_resources'>resources</span><span class='comma'>,</span> <span class='id identifier rubyid_profile_url'>profile_url</span><span class='comma'>,</span> <span class='label'>validator_name:</span> <span class='symbol'>:default</span><span class='comma'>,</span> <span class='label'>metadata:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                         <span class='label'>requirement_extension:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_missing_elements'>missing_elements</span> <span class='op'>=</span> <span class='id identifier rubyid_missing_must_support_elements'>missing_must_support_elements</span><span class='lparen'>(</span><span class='id identifier rubyid_resources'>resources</span><span class='comma'>,</span> <span class='id identifier rubyid_profile_url'>profile_url</span><span class='comma'>,</span> <span class='label'>validator_name:</span><span class='comma'>,</span> <span class='label'>metadata:</span><span class='comma'>,</span>
                                                                           <span class='label'>requirement_extension:</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_missing_elements'>missing_elements</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span><span class='comma'>,</span> <span class='id identifier rubyid_missing_must_support_elements_message'>missing_must_support_elements_message</span><span class='lparen'>(</span><span class='id identifier rubyid_missing_elements'>missing_elements</span><span class='comma'>,</span> <span class='id identifier rubyid_resources'>resources</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="assert_resource_type-instance_method">
  
    #<strong>assert_resource_type</strong>(resource_type, resource: self.resource)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Check a FHIR resource’s type</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='comment'># The resource type can be a symbol, String, or FHIR::Model class
</span><span class='id identifier rubyid_assert_resource_type'>assert_resource_type</span><span class='lparen'>(</span><span class='symbol'>:capability_statement</span><span class='rparen'>)</span>
<span class='id identifier rubyid_assert_resource_type'>assert_resource_type</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CapabilityStatement</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_assert_resource_type'>assert_resource_type</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../FHIR.html" title="FHIR (module)">FHIR</a></span></span><span class='op'>::</span><span class='const'>CapabilityStatement</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>resource_type</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Symbol</tt>, <tt>Class</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>resource</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../FHIR/Model.html" title="FHIR::Model (class)">FHIR::Model</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>self.resource</tt>)</em>
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


52
53
54
55
56
57</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/inferno/dsl/assertions.rb', line 52</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_resource_type'>assert_resource_type</span><span class='lparen'>(</span><span class='id identifier rubyid_resource_type'>resource_type</span><span class='comma'>,</span> <span class='label'>resource:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_resource'>resource</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_resource_type_name'>resource_type_name</span> <span class='op'>=</span> <span class='id identifier rubyid_normalize_resource_type'>normalize_resource_type</span><span class='lparen'>(</span><span class='id identifier rubyid_resource_type'>resource_type</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_resource'>resource</span><span class='op'>&amp;.</span><span class='id identifier rubyid_resourceType'>resourceType</span> <span class='op'>==</span> <span class='id identifier rubyid_resource_type_name'>resource_type_name</span><span class='comma'>,</span>
         <span class='id identifier rubyid_bad_resource_type_message'>bad_resource_type_message</span><span class='lparen'>(</span><span class='id identifier rubyid_resource_type_name'>resource_type_name</span><span class='comma'>,</span> <span class='id identifier rubyid_resource'>resource</span><span class='op'>&amp;.</span><span class='id identifier rubyid_resourceType'>resourceType</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="assert_response_content_type-instance_method">
  
    #<strong>assert_response_content_type</strong>(type, request: self.request)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Check the Content-Type header of a response. This assertion will fail if
the response’s content type does not begin with the provided type.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>type</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>request</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Entities/Request.html" title="Inferno::Entities::Request (class)">Inferno::Entities::Request</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>self.request</tt>)</em>
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


185
186
187
188
189
190</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/inferno/dsl/assertions.rb', line 185</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_response_content_type'>assert_response_content_type</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='label'>request:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_request'>request</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_header'>header</span> <span class='op'>=</span> <span class='id identifier rubyid_request'>request</span><span class='period'>.</span><span class='id identifier rubyid_response_header'>response_header</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Content-Type</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_header'>header</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span><span class='comma'>,</span> <span class='id identifier rubyid_no_content_type_message'>no_content_type_message</span>

  <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_header'>header</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_start_with?'>start_with?</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_bad_content_type_message'>bad_content_type_message</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_header'>header</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="assert_response_status-instance_method">
  
    #<strong>assert_response_status</strong>(status, request: self.request, response: nil)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Check a response’s status</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>status</span>
      
      
        <span class='type'>(<tt>Integer</tt>, <tt>Array&lt;Integer&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a single integer or an array of
integer status codes</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>request</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Entities/Request.html" title="Inferno::Entities::Request (class)">Inferno::Entities::Request</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>self.request</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>response</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


32
33
34
35</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/inferno/dsl/assertions.rb', line 32</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_response_status'>assert_response_status</span><span class='lparen'>(</span><span class='id identifier rubyid_status'>status</span><span class='comma'>,</span> <span class='label'>request:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_request'>request</span><span class='comma'>,</span> <span class='label'>response:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_response'>response</span> <span class='op'>||=</span> <span class='id identifier rubyid_request'>request</span><span class='op'>&amp;.</span><span class='id identifier rubyid_response'>response</span>
  <span class='id identifier rubyid_assert'>assert</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_wrap'>wrap</span><span class='lparen'>(</span><span class='id identifier rubyid_status'>status</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_bad_response_status_message'>bad_response_status_message</span><span class='lparen'>(</span><span class='id identifier rubyid_status'>status</span><span class='comma'>,</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="assert_valid_bundle_entries-instance_method">
  
    #<strong>assert_valid_bundle_entries</strong>(bundle: resource, resource_types: {})  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Validate each entry of a Bundle</p>

<p>[String,Symbol,FHIR::Model,Array&lt;String,Symbol,FHIR::Model&gt;,Hash] If a
  string, symbol, or FHIR::Model is provided, only that resource type
  will be validated. If an array of strings is provided, only those
  resource types will be validated. If a hash is provided with resource
  types as keys and profile urls (or nil) as values, only those resource
  types will be validated against the provided profile url or the base
  resource if nil.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='comment'># Only validate Patient bundle entries
</span><span class='id identifier rubyid_assert_valid_bundle_entries'>assert_valid_bundle_entries</span><span class='lparen'>(</span><span class='label'>resource_types:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Patient</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

<span class='comment'># Only valiadte Patient and Condition bundle entries
</span><span class='id identifier rubyid_assert_valid_bundle_entries'>assert_valid_bundle_entries</span><span class='lparen'>(</span><span class='label'>resource_types:</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Patient</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Condition</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>

<span class='comment'># Only validate Patient and Condition bundle entries. Validate Patient
</span><span class='comment'># resources against the given profile, and Codition resources against the
</span><span class='comment'># base FHIR Condition resource.
</span><span class='id identifier rubyid_assert_valid_bundle_entries'>assert_valid_bundle_entries</span><span class='lparen'>(</span>
  <span class='label'>resource_types:</span> <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Patient</span><span class='label_end'>&#39;:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Condition</span><span class='label_end'>&#39;:</span> <span class='kw'>nil</span>
  <span class='rbrace'>}</span>
<span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>bundle</span>
      
      
        <span class='type'>(<tt>FHIR::Bundle</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>resource</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>resource_types</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/inferno/dsl/assertions.rb', line 107</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_valid_bundle_entries'>assert_valid_bundle_entries</span><span class='lparen'>(</span><span class='label'>bundle:</span> <span class='id identifier rubyid_resource'>resource</span><span class='comma'>,</span> <span class='label'>resource_types:</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_assert_resource_type'>assert_resource_type</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Bundle</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>resource:</span> <span class='id identifier rubyid_bundle'>bundle</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_types_to_check'>types_to_check</span> <span class='op'>=</span> <span class='id identifier rubyid_normalize_types_to_check'>normalize_types_to_check</span><span class='lparen'>(</span><span class='id identifier rubyid_resource_types'>resource_types</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_invalid_resources'>invalid_resources</span> <span class='op'>=</span>
    <span class='id identifier rubyid_bundle'>bundle</span>
      <span class='period'>.</span><span class='id identifier rubyid_entry'>entry</span>
      <span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:resource</span><span class='rparen'>)</span>
      <span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_resource'>resource</span><span class='op'>|</span> <span class='id identifier rubyid_types_to_check'>types_to_check</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>||</span> <span class='id identifier rubyid_types_to_check'>types_to_check</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_resource'>resource</span><span class='period'>.</span><span class='id identifier rubyid_resourceType'>resourceType</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='period'>.</span><span class='id identifier rubyid_reject'>reject</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_resource'>resource</span><span class='op'>|</span>
        <span class='id identifier rubyid_validation_params'>validation_params</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>resource:</span> <span class='rbrace'>}</span>
        <span class='id identifier rubyid_profile'>profile</span> <span class='op'>=</span> <span class='id identifier rubyid_types_to_check'>types_to_check</span><span class='lbracket'>[</span><span class='id identifier rubyid_resource'>resource</span><span class='period'>.</span><span class='id identifier rubyid_resourceType'>resourceType</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_validation_params'>validation_params</span><span class='lbracket'>[</span><span class='symbol'>:profile_url</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_profile'>profile</span> <span class='kw'>if</span> <span class='id identifier rubyid_profile'>profile</span>

        <span class='id identifier rubyid_resource_is_valid?'>resource_is_valid?</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_validation_params'>validation_params</span><span class='rparen'>)</span>
      <span class='kw'>end</span>

  <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_invalid_resources'>invalid_resources</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span><span class='comma'>,</span> <span class='id identifier rubyid_invalid_bundle_entries_message'>invalid_bundle_entries_message</span><span class='lparen'>(</span><span class='id identifier rubyid_invalid_resources'>invalid_resources</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="assert_valid_http_uri-instance_method">
  
    #<strong>assert_valid_http_uri</strong>(uri, message = &#39;&#39;)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Check for a valid http/https uri</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>uri</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>message</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>custom failure message</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


174
175
176
177</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/inferno/dsl/assertions.rb', line 174</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_valid_http_uri'>assert_valid_http_uri</span><span class='lparen'>(</span><span class='id identifier rubyid_uri'>uri</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_error_message'>error_message</span> <span class='op'>=</span> <span class='id identifier rubyid_message'>message</span><span class='period'>.</span><span class='id identifier rubyid_presence'>presence</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_uri'>uri</span><span class='embexpr_end'>}</span><span class='tstring_content'>\&quot; is not a valid URI</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\A</span><span class='embexpr_beg'>#{</span><span class='const'>URI</span><span class='op'>::</span><span class='const'>DEFAULT_PARSER</span><span class='period'>.</span><span class='id identifier rubyid_make_regexp'>make_regexp</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>http</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>https</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>\z</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='id identifier rubyid_error_message'>error_message</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="assert_valid_json-instance_method">
  
    #<strong>assert_valid_json</strong>(maybe_json_string, message = &#39;&#39;)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Check for valid JSON</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>maybe_json_string</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>message</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>extra failure message</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


163
164
165
166
167</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/inferno/dsl/assertions.rb', line 163</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_valid_json'>assert_valid_json</span><span class='lparen'>(</span><span class='id identifier rubyid_maybe_json_string'>maybe_json_string</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_assert'>assert</span> <span class='const'>JSON</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_maybe_json_string'>maybe_json_string</span><span class='rparen'>)</span>
<span class='kw'>rescue</span> <span class='const'>JSON</span><span class='op'>::</span><span class='const'>ParserError</span>
  <span class='id identifier rubyid_assert'>assert</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid JSON. </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_message'>message</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="assert_valid_resource-instance_method">
  
    #<strong>assert_valid_resource</strong>(resource: self.resource, profile_url: nil, validator: :default)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Validate a FHIR resource</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>resource</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../FHIR/Model.html" title="FHIR::Model (class)">FHIR::Model</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>self.resource</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>profile_url</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>canonical url of the profile to validate against,
may include a version separated by a vertical bar (|),
and defaults to validating against the base FHIR resource type</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>validator</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>:default</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>the name of the validator to use</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


74
75
76
77</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/inferno/dsl/assertions.rb', line 74</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assert_valid_resource'>assert_valid_resource</span><span class='lparen'>(</span><span class='label'>resource:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_resource'>resource</span><span class='comma'>,</span> <span class='label'>profile_url:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>validator:</span> <span class='symbol'>:default</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_resource_is_valid?'>resource_is_valid?</span><span class='lparen'>(</span><span class='label'>resource:</span><span class='comma'>,</span> <span class='label'>profile_url:</span><span class='comma'>,</span> <span class='label'>validator:</span><span class='rparen'>)</span><span class='comma'>,</span>
         <span class='id identifier rubyid_invalid_resource_message'>invalid_resource_message</span><span class='lparen'>(</span><span class='id identifier rubyid_resource'>resource</span><span class='comma'>,</span> <span class='id identifier rubyid_profile_url'>profile_url</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Jul 30 13:16:41 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.3.6).
</div>

    </div>
  </body>
</html>